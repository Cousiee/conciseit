---
import { APP_PROJECTS } from "~/utils/config";

import { fetchProjects, getRelatedProjects } from "~/utils/projects";
import HighlightedProjects from "~/components/projects/HighlightedProjects.astro";
import type { Project } from "~/types";
import { getProjectsPermalink } from "~/utils/permalinks";

export interface Props {
  project: Project;
}

const { project } = Astro.props;
const fetchedProjects = await fetchProjects();
const relatedProjects = project.category ? getRelatedProjects(fetchedProjects, project.slug, project.category) : [];
---

{
  APP_PROJECTS.isRelatedProjectsEnabled ? (
    <HighlightedProjects
      classes={{ container: "pt-4 md:pt-6 lg:pt-8 " }}
      title="Related Projects"
      linkText="View All Projects"
      linkUrl={getProjectsPermalink()}
      projectIds={relatedProjects.map((project) => project.id)}
    />
  ) : null
}
